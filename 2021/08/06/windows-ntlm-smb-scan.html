<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>NTLMç«¯å£ä¿¡æ¯æ¢æµ‹ | ğŸ˜Š#</title>
  <meta name="author" content="JKme">
  
  <meta name="description" content="SMBï¼ˆServer Message Blockï¼‰åè®®ï¼Œå¯ç”¨äºåœ¨è®¡ç®—æœºé—´å…±äº«æ–‡ä»¶ã€æ‰“å°æœºã€ä¸²å£ç­‰ï¼Œç”µè„‘ä¸Šçš„ç½‘ä¸Šé‚»å±…å°±æ˜¯é å®ƒå®ç°çš„ã€‚SMBä½¿ç”¨äº†NetBIOSçš„åº”ç”¨ç¨‹åºæ¥å£ ï¼ˆApplication Program Interfaceï¼Œç®€ç§°APIï¼‰ã€‚å¦å¤–ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€æ”¾æ€§çš„åè®®ï¼Œå…è®¸äº†åè®®æ‰©å±•â€”â€”ä½¿å¾—å®ƒå˜å¾—æ›´å¤§è€Œä¸”å¤æ‚ï¼›å¤§çº¦æœ‰65ä¸ªæœ€ä¸Šå±‚çš„ä½œä¸šï¼Œè€Œæ¯ä¸ªä½œä¸šéƒ½è¶…è¿‡120ä¸ªå‡½æ•°ï¼Œç”šè‡³Windows NTä¹Ÿæ²¡æœ‰å…¨éƒ¨æ”¯æŒåˆ°ï¼Œæœ€è¿‘å¾®è½¯åˆæŠŠ SMB æ”¹åä¸º CIFSï¼ˆCommon Internet File Systemï¼‰ï¼Œå¹¶ä¸”åŠ å…¥äº†è®¸å¤šæ–°çš„ç‰¹è‰²ã€‚SMBåè®®ä¸€èˆ¬ç«¯å£ä½¿ç”¨ä¸º139ï¼Œ445ï¼ŒCIFSåè®®æœ‰ä¸‰ä¸ªç‰ˆæœ¬ï¼šSMBã€SMB2ã€SMB3ã€‚
NTLMåœ¨type2è¿”å›Challengeçš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ—¶è¿”å›äº†æ“ä½œç³»ç»Ÿç±»å‹ï¼Œä¸»æœºåï¼Œnetbiosåç­‰ç­‰ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœæˆ‘ä»¬åœ¨èƒ½è·ŸæœåŠ¡å™¨è¿›è¡ŒNTLMäº¤æµä¸­ï¼Œç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªtype1çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›type2çš„å“åº”ï¼Œè¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¾ˆå¤šä¿¡æ¯ã€‚SMBv1å’ŒSMBv2çš„æ•°æ®åŒ…ç»“æ„æ˜¯ä¸åŒçš„
SMBv1ä½¿ç”¨éæ”»NTLMINFOæ¢æµ‹SMBæ¥å£ï¼ŒæŠ“åŒ…é€šè¿‡wiresharkåˆ†æï¼ŒåŒ…å«æ“ä½œç³»ç»Ÿç±»å‹çš„æ•°æ®åŒ…ç”±SMB Headerå’ŒResponseç»„æˆï¼šæˆ‘ä»¬çš„ç›®çš„æ˜¯è·å–smbæ•°æ®åŒ…çš„NTLMæ•°æ®ï¼Œç„¶åå¯¹NTLMæ•°æ®åŒ…è§£æï¼ŒNTLMæ•°æ®åŒ…ä¸Šä¸€å±‚æ˜¯GSS-APIï¼Œé¦–å…ˆæ‰¾åˆ°GSS-APIåœ¨æ•´ä¸ªæ•°æ®åŒ…çš„åç§»é‡ï¼ŒSMBçš„æ•°æ®åŒ…ç»“æ„é•¿åº¦å¦‚ä¸‹ï¼š
SMB Header:  32 byte
Word Count:  1 byte
AndXCommand: 1 byte
Reserved:    1 byte
AndXOffset:  2 byte
Action: 	   2 byte
Security Blob Length: 2 byte (è¡¨ç¤ºSecurity Blobçš„é•¿åº¦ï¼Œè¿™é‡Œçš„hexæ˜¯ 0f 10ï¼Œå°ç«¯è½¬æ¢ä¸º010f,å†è½¬æ¢æˆ10è¿›åˆ¶å°±æ˜¯271ï¼Œå¯¹åº”Security Blobçš„é•¿åº¦)
Byte Count: 2 byte (è¡¨ç¤ºSecurity BlobåŠ ä¸ŠNativeOSå’ŒNative Lançš„é•¿åº¦)
Security Blob: å¯å˜é•¿åº¦ï¼Œå–å†³äºSecurity Blob Length
ä¸Šé¢çš„æ•°æ®åŒ…ç»“æ„çš„å…³é”®æ•°æ®æ˜¯Security Blob Lengthå’ŒByte Contentï¼Œå‰è€…è¡¨ç¤ºGSS-APIçš„æ•´ä¸ªæ•°æ®åŒ…é•¿åº¦ï¼Œåè€…è¡¨ç¤ºGSS-APIå’ŒNative OSåŠ ä¸ŠNative LMçš„æ•°æ®é•¿åº¦ï¼š
GSS-APIçš„é•¿åº¦æ˜¯271 Byte
Native OSçš„é•¿åº¦æ˜¯42 Byte"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="NTLMç«¯å£ä¿¡æ¯æ¢æµ‹"/>
  <meta property="og:site_name" content="ğŸ˜Š#"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  

  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" href="/css/prism-atom-dark.css" media="screen" type="text/css">
    <link rel="stylesheet" href="/css/prism-line-numbers.css" media="screen" type="text/css">
  <script src="/js/jquery-2.0.3.min.js"></script>
<!--   <script src="/js/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <link rel="stylesheet" href="/css/highlight/styles/atom-one-dark.min.css" media="screen" type="text/css"> -->

  <!-- analytics -->
  




<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="ğŸ˜Š#" type="application/atom+xml">
</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">ğŸ˜Š#</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/project" title="All the categories.">
			  <i class=""></i>Projects
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> NTLMç«¯å£ä¿¡æ¯æ¢æµ‹</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>SMBï¼ˆServer Message Blockï¼‰åè®®ï¼Œå¯ç”¨äºåœ¨è®¡ç®—æœºé—´å…±äº«æ–‡ä»¶ã€æ‰“å°æœºã€ä¸²å£ç­‰ï¼Œç”µè„‘ä¸Šçš„ç½‘ä¸Šé‚»å±…å°±æ˜¯é å®ƒå®ç°çš„ã€‚SMBä½¿ç”¨äº†NetBIOSçš„åº”ç”¨ç¨‹åºæ¥å£ ï¼ˆApplication Program Interfaceï¼Œç®€ç§°APIï¼‰ã€‚å¦å¤–ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€æ”¾æ€§çš„åè®®ï¼Œå…è®¸äº†åè®®æ‰©å±•â€”â€”ä½¿å¾—å®ƒå˜å¾—æ›´å¤§è€Œä¸”å¤æ‚ï¼›å¤§çº¦æœ‰65ä¸ªæœ€ä¸Šå±‚çš„ä½œä¸šï¼Œè€Œæ¯ä¸ªä½œä¸šéƒ½è¶…è¿‡120ä¸ªå‡½æ•°ï¼Œç”šè‡³Windows NTä¹Ÿæ²¡æœ‰å…¨éƒ¨æ”¯æŒåˆ°ï¼Œæœ€è¿‘å¾®è½¯åˆæŠŠ SMB æ”¹åä¸º CIFSï¼ˆCommon Internet File Systemï¼‰ï¼Œå¹¶ä¸”åŠ å…¥äº†è®¸å¤šæ–°çš„ç‰¹è‰²ã€‚SMBåè®®ä¸€èˆ¬ç«¯å£ä½¿ç”¨ä¸º139ï¼Œ445ï¼ŒCIFSåè®®æœ‰ä¸‰ä¸ªç‰ˆæœ¬ï¼šSMBã€SMB2ã€SMB3ã€‚</p>
<h3 id="NTLM"><a href="#NTLM" class="headerlink" title="NTLM"></a>NTLM</h3><p>åœ¨type2è¿”å›Challengeçš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ—¶è¿”å›äº†æ“ä½œç³»ç»Ÿç±»å‹ï¼Œä¸»æœºåï¼Œnetbiosåç­‰ç­‰ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœæˆ‘ä»¬åœ¨èƒ½è·ŸæœåŠ¡å™¨è¿›è¡ŒNTLMäº¤æµä¸­ï¼Œç»™æœåŠ¡å™¨å‘é€ä¸€ä¸ªtype1çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›type2çš„å“åº”ï¼Œè¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¾ˆå¤šä¿¡æ¯ã€‚SMBv1å’ŒSMBv2çš„æ•°æ®åŒ…ç»“æ„æ˜¯ä¸åŒçš„</p>
<h3 id="SMBv1"><a href="#SMBv1" class="headerlink" title="SMBv1"></a>SMBv1</h3><p>ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/FeigongSec/NTLMINFO">éæ”»NTLMINFO</a>æ¢æµ‹SMBæ¥å£ï¼ŒæŠ“åŒ…é€šè¿‡wiresharkåˆ†æï¼ŒåŒ…å«æ“ä½œç³»ç»Ÿç±»å‹çš„æ•°æ®åŒ…ç”±SMB Headerå’ŒResponseç»„æˆï¼š<br><img src="/2021/08/06/windows-ntlm-smb-scan/ntlm-1.png"><br>æˆ‘ä»¬çš„ç›®çš„æ˜¯è·å–smbæ•°æ®åŒ…çš„NTLMæ•°æ®ï¼Œç„¶åå¯¹NTLMæ•°æ®åŒ…è§£æï¼ŒNTLMæ•°æ®åŒ…ä¸Šä¸€å±‚æ˜¯GSS-APIï¼Œé¦–å…ˆæ‰¾åˆ°GSS-APIåœ¨æ•´ä¸ªæ•°æ®åŒ…çš„åç§»é‡ï¼ŒSMBçš„æ•°æ®åŒ…ç»“æ„é•¿åº¦å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">SMB Header:  32 byte
Word Count:  1 byte
AndXCommand: 1 byte
Reserved:    1 byte
AndXOffset:  2 byte
Action: 	   2 byte
Security Blob Length: 2 byte (è¡¨ç¤ºSecurity Blobçš„é•¿åº¦ï¼Œè¿™é‡Œçš„hexæ˜¯ 0f 10ï¼Œå°ç«¯è½¬æ¢ä¸º010f,å†è½¬æ¢æˆ10è¿›åˆ¶å°±æ˜¯271ï¼Œå¯¹åº”Security Blobçš„é•¿åº¦)
Byte Count: 2 byte (è¡¨ç¤ºSecurity BlobåŠ ä¸ŠNativeOSå’ŒNative Lançš„é•¿åº¦)
Security Blob: å¯å˜é•¿åº¦ï¼Œå–å†³äºSecurity Blob Length<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ä¸Šé¢çš„æ•°æ®åŒ…ç»“æ„çš„å…³é”®æ•°æ®æ˜¯<code>Security Blob Length</code>å’Œ<code>Byte Content</code>ï¼Œå‰è€…è¡¨ç¤ºGSS-APIçš„æ•´ä¸ªæ•°æ®åŒ…é•¿åº¦ï¼Œåè€…è¡¨ç¤ºGSS-APIå’ŒNative OSåŠ ä¸ŠNative LMçš„æ•°æ®é•¿åº¦ï¼š</p>
<h6 id="GSS-APIçš„é•¿åº¦æ˜¯271-Byte"><a href="#GSS-APIçš„é•¿åº¦æ˜¯271-Byte" class="headerlink" title="GSS-APIçš„é•¿åº¦æ˜¯271 Byte"></a>GSS-APIçš„é•¿åº¦æ˜¯271 Byte</h6><p><img src="/2021/08/06/windows-ntlm-smb-scan/ntlm-3.png"></p>
<h6 id="Native-OSçš„é•¿åº¦æ˜¯42-Byte"><a href="#Native-OSçš„é•¿åº¦æ˜¯42-Byte" class="headerlink" title="Native OSçš„é•¿åº¦æ˜¯42 Byte"></a>Native OSçš„é•¿åº¦æ˜¯42 Byte</h6><p><img src="/2021/08/06/windows-ntlm-smb-scan/ntlm-3.1.png"></p>
<h6 id="Native-LMçš„é•¿åº¦æ˜¯38-Byte"><a href="#Native-LMçš„é•¿åº¦æ˜¯38-Byte" class="headerlink" title="Native LMçš„é•¿åº¦æ˜¯38 Byte"></a>Native LMçš„é•¿åº¦æ˜¯38 Byte</h6><p><img src="/2021/08/06/windows-ntlm-smb-scan/ntlm-3.2.png"></p>
<p>æ‰€ä»¥æ•°å­¦é¢˜æ¥äº†ï¼š<br>Security Blob Lengthè½¬æ¢æˆ10è¿›åˆ¶æ˜¯271 Byte</p>
<p>Byte Count: 271 + 42 + 38 = 351 Byte<br>æˆ‘ä»¬çš„ç›®çš„æ˜¯è·å–NTLMçš„æ•°æ®å’ŒNativeOSå’ŒNative LMï¼Œå›åˆ°ä»£ç é‡Œé¢å»çœ‹çœ‹ï¼Œå½“æˆ‘ä»¬è·å–åˆ°type2çš„æ•°æ®ï¼Œè·å–åˆ°çš„æ•°æ®æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</p>
<p><img src="/2021/08/06/windows-ntlm-smb-scan/ntlm-4.png"></p>
<p>NetBIOS Session Serviceè¿™ä¸€å±‚çš„é•¿åº¦æ˜¯4 Byteï¼Œ<code>Security Blob Length</code>çš„åç§»é‡å°±å‡ºæ¥äº†: </p>
<pre class="line-numbers language-none"><code class="language-none">4 + 32 + 1 + 1 + 1 + 2 + 2 &#x3D; 43<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>æ‰€ä»¥<code>Security Blob Length</code>åç§»ä»43å¼€å§‹ï¼Œé•¿åº¦æ˜¯2 Byteï¼Œ <code>Security Blob</code>è·Ÿåœ¨åé¢ï¼Œåç§»ä»45å¼€å§‹ï¼Œ47ç»“æŸï¼Œgoè¯­è¨€ä¼ªä»£ç ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">blob_length :&#x3D; uint16(bytes2Uint(ret[43:45], &#39;&lt;&#39;))
blob_count :&#x3D; uint16(bytes2Uint(ret[45:47], &#39;&lt;&#39;))
&#x2F;&#x2F;gsså˜é‡è¡¨ç¤ºä»Security Blobèµ·å§‹ä½ç½®åˆ°æ•°æ®åŒ…ç»“æŸï¼ŒåŒ…æ‹¬äº†Native OSå’ŒNative LM
gss :&#x3D; ret[47:]

&#x2F;&#x2F;æ‰¾åˆ°NTLMSSPåœ¨gssçš„åç§»èµ·å§‹ä½ç½®
off_ntlm :&#x3D; bytes.Index(gss, []byte(&quot;NTLMSSP&quot;))

&#x2F;&#x2F;Native OSå’ŒNative LMæ•°æ®ï¼Œå¯¹åº”ä¸Šé¢çš„å›¾
native :&#x3D; gss[int(blob_length):blob_count]

&#x2F;&#x2F;bsè¡¨ç¤ºntlmçš„æ•°æ®ï¼Œä»¥NTLMSSPå¼€å¤´
bs :&#x3D; gss[off_ntlm:blob_length]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>æ¥ä¸‹æ¥ä¸»è¦å·¥ä½œå°±æ˜¯è§£æNTLMçš„æ•°æ®ï¼Œæ„Ÿè°¢iv4nå¸ˆå‚…çš„<a target="_blank" rel="noopener" href="http://iv4n.cc/ntlmssp/">Windows NTLMåè®®ç»†èŠ‚</a>ï¼Œæˆ‘forkäº†ä¸€ä»½<a target="_blank" rel="noopener" href="https://github.com/JKme/go-ntlmssp">go-ntlmssp</a>ï¼Œå¢åŠ äº†è§£æNTLMè¾“å‡ºå­—ç¬¦ä¸²å‡½æ•°ï¼Œå¯ä»¥ç›´æ¥è·å–NTLMSSPæ•°æ®çš„è§£æç»“æœï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">func TestChallengeMsg_String(t *testing.T) &#123;
	bs, _ :&#x3D; hex.DecodeString(&quot;4e544c4d535350xxxxx&quot;)
	type2 :&#x3D; ChallengeMsg&#123;&#125;
	info :&#x3D; type2.String(bs)
	fmt.Println(info)
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2021/08/06/windows-ntlm-smb-scan/ntlm-5.png"></p>
<p>Windows10é»˜è®¤ä½¿ç”¨SMBv2åè®®ï¼Œæ²¡æœ‰æ‰“å¼€SMBv1å¼€å…³ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/RowTeam/SharpDetectionNTLMSSP">Rcollå¸ˆå‚…çš„SharpDetectionNTLMSSP</a>åªå‘é€äº†SMBv1çš„æ¢æµ‹ï¼Œæ²¡æœ‰æ¢æµ‹SMBv2ã€‚<a target="_blank" rel="noopener" href="https://github.com/FeigongSec/NTLMINFO">éæ”»NTLMINFO</a>å¸ˆå‚…å°±æ¯”è¾ƒå®Œæ•´ï¼Œå…ˆæ¢æµ‹SMBv1ï¼Œå¤±è´¥ä¹‹åå°è¯•SMBv2ã€‚</p>
<h3 id="SMBv2"><a href="#SMBv2" class="headerlink" title="SMBv2"></a>SMBv2</h3><p>å‚è€ƒ<a target="_blank" rel="noopener" href="https://github.com/FeigongSec/NTLMINFO/blob/016e1859b7c0f4cc55c923027bc24174b0586bc7/SmbInfo/SmbInfo/Program.cs#L83">éæ”»å¸ˆå‚…çš„ä»£ç </a>ï¼Œå…ˆå‘é€ç¬¬ä¸€æ¬¡çš„æ¢æµ‹è¯·æ±‚ï¼Œæ‰¾åˆ°åç§»é‡70çš„åœ°æ–¹ï¼Œåšä¸€æ¬¡åˆ¤æ–­æ˜¯å¦å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ…ã€‚æ¢æˆGOä»£ç å°±æ¯”è¾ƒç®€å•äº†ï¼Œè¿™é‡Œçš„åç§»70ä¿å­˜çš„æ˜¯æ˜¯SMBv2çš„<code>Security mode</code>:</p>
<p><img src="/2021/08/06/windows-ntlm-smb-scan/ntlm-6.png"></p>
<p>Goè¯­è¨€å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">var NTLMSSPNegotiatev2Data []byte
if hex.EncodeToString(r2[70:71]) &#x3D;&#x3D; &quot;03&quot; &#123;
	flags :&#x3D; []byte&#123;0x15, 0x82, 0x08, 0xa0&#125;
	NTLMSSPNegotiatev2Data &#x3D; getNTLMSSPNegotiateData(flags)
&#125; else &#123;
	flags :&#x3D; []byte&#123;0x05, 0x80, 0x08, 0xa0&#125;
	NTLMSSPNegotiatev2Data &#x3D; getNTLMSSPNegotiateData(flags)
&#125;

_, err &#x3D; conn2.Write(NegotiateSMBv2Data2)
if err !&#x3D; nil &#123;
	return
&#125;
readBytes(conn2)

_, err &#x3D; conn2.Write(NTLMSSPNegotiatev2Data)
ret, _ :&#x3D; readBytes(conn2)
ntlmOff :&#x3D; bytes.Index(ret, []byte(&quot;NTLMSSP&quot;))<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆå“ä¸»è¦å‚è€ƒéæ”»å¸ˆå‚…çš„ä»£ç ï¼Œé›†æˆåˆ°<a target="_blank" rel="noopener" href="https://github.com/JKme/cube">Cube</a>ï¼Œå®Œæˆäº†winrmã€wmiã€smbã€mssqlç«¯å£çš„NTLMä¿¡æ¯æ¢æµ‹ã€‚</p>
<h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/FeigongSec/NTLMINFO">éæ”»NTLMINFO</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/RowTeam/SharpDetectionNTLMSSP">Rcollå¸ˆå‚…çš„SharpDetectionNTLMSSP</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/zmap/zgrab2/tree/master/lib/smb/smb">An SMB library in Go</a></li>
<li><a target="_blank" rel="noopener" href="https://daiker.gitbook.io/windows-protocol/ntlm-pian/4">NTLMåŸºç¡€ä»‹ç»</a></li>
<li><a target="_blank" rel="noopener" href="http://iv4n.cc/ntlmssp/">Windows NTLMåè®®ç»†èŠ‚</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-smb/f210069c-7086-4dc2-885e-861d837df688">Server Message Block (SMB) Protocol</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-smb2/5606ad47-5ee0-437a-817e-70c366052962">Server Message Block (SMB) Protocol Versions 2 and 3</a></li>
</ul>

	</div>

	
	<span id="/2021/08/06/windows-ntlm-smb-scan.html" class="leancloud-visitors view" data-flag-title="NTLMç«¯å£ä¿¡æ¯æ¢æµ‹">
	</span>
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2022/03/18/from-spring-boot-to-getshell.html" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2021/08/02/siem-on-elk.html" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2021-08-06 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/Pentest/">Pentest<span>51</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#NTLM"><span class="toc-article-text">NTLM</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#SMBv1"><span class="toc-article-text">SMBv1</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-6"><a class="toc-article-link" href="#GSS-API%E7%9A%84%E9%95%BF%E5%BA%A6%E6%98%AF271-Byte"><span class="toc-article-text">GSS-APIçš„é•¿åº¦æ˜¯271 Byte</span></a></li><li class="toc-article-item toc-article-level-6"><a class="toc-article-link" href="#Native-OS%E7%9A%84%E9%95%BF%E5%BA%A6%E6%98%AF42-Byte"><span class="toc-article-text">Native OSçš„é•¿åº¦æ˜¯42 Byte</span></a></li><li class="toc-article-item toc-article-level-6"><a class="toc-article-link" href="#Native-LM%E7%9A%84%E9%95%BF%E5%BA%A6%E6%98%AF38-Byte"><span class="toc-article-text">Native LMçš„é•¿åº¦æ˜¯38 Byte</span></a></li></ol></li></ol></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#SMBv2"><span class="toc-article-text">SMBv2</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%8F%82%E8%80%83"><span class="toc-article-text">å‚è€ƒ</span></a></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2023 JKme's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>â¬†ï¸TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
